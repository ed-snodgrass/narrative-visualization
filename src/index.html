<html>
<head>
  <title>U of I - CS416 Narrative Visualization</title>
  <link type="image/x-icon" href="assets/favicon.ico" rel="icon">
</head>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style>
    circle {
        fill: lightblue;
        stroke: black;
    }
</style>
<body>

<div>
  <svg id="scene-1" width=300 height=300></svg>
</div>
<div>
  <svg id="scene-2" width=300 height=300></svg>
</div>
<div>
  <svg id="scene-3" width=300 height=300></svg>
</div>

<script>
  window.addEventListener("load", (event) => {
    init()
  });
  const margin = 50
  const width = 200
  const height = 200

  const tickValues = [10, 20, 50, 100]
  const tickFormat = d3.format('~s')

  function buildScene1(data) {

    const x = d3.scaleLog([10, 150], [0, width]).base(10)
    const y = d3.scaleLog([10, 150], [height, 0]).base(10)

    d3.select('#scene-1')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + margin + ')')
      .selectAll('path')
      .data(data)
      .enter()
      .append('circle')
      .attr('cx', function (d) {
        return x(d.AverageCityMPG)
      })
      .attr('cy', function (d) {
        return y(d.AverageHighwayMPG)
      })
      .attr('r', function (d) {
        return 2 + +d.EngineCylinders
      })

    d3.select('#scene-1')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + margin + ')')
      .call(d3.axisLeft(y).tickValues(tickValues).tickFormat(tickFormat))

    d3.select('#scene-1')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + (height + margin) + ')')
      .call(d3.axisBottom(x).tickValues(tickValues).tickFormat(tickFormat))

  }

  function buildScene2(data) {

    const x = d3.scaleLog([10, 150], [0, width]).base(10)
    const y = d3.scaleLog([10, 150], [height, 0]).base(10)

    d3.select('#scene-2')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + margin + ')')
      .selectAll('path')
      .data(data)
      .enter()
      .append('circle')
      .attr('cx', function (d) {
        return x(d.AverageCityMPG)
      })
      .attr('cy', function (d) {
        return y(d.AverageHighwayMPG)
      })
      .attr('r', function (d) {
        return 2 + +d.EngineCylinders
      })

    d3.select('#scene-2')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + margin + ')')
      .call(d3.axisLeft(y).tickValues(tickValues).tickFormat(tickFormat))

    d3.select('#scene-2')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + (height + margin) + ')')
      .call(d3.axisBottom(x).tickValues(tickValues).tickFormat(tickFormat))

  }

  function buildScene3(data) {

    const x = d3.scaleLog([10, 150], [0, width]).base(10)
    const y = d3.scaleLog([10, 150], [height, 0]).base(10)

    d3.select('#scene-3')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + margin + ')')
      .selectAll('path')
      .data(data)
      .enter()
      .append('circle')
      .attr('cx', function (d) {
        return x(d.AverageCityMPG)
      })
      .attr('cy', function (d) {
        return y(d.AverageHighwayMPG)
      })
      .attr('r', function (d) {
        return 2 + +d.EngineCylinders
      })

    d3.select('#scene-3')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + margin + ')')
      .call(d3.axisLeft(y).tickValues(tickValues).tickFormat(tickFormat))

    d3.select('#scene-3')
      .append('g')
      .attr('transform', 'translate(' + margin + ',' + (height + margin) + ')')
      .call(d3.axisBottom(x).tickValues(tickValues).tickFormat(tickFormat))

  }

  async function init() {
    const data = await d3.csv('https://flunky.github.io/cars2017.csv')

    buildScene1(data)
    buildScene2(data)
    buildScene3(data)
  }

</script>
</body>
</html>
